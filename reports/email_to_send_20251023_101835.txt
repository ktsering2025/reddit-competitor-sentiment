To: {"method":"tools/call","params":{"name":"bash","arguments":{"command":"cd /Users/kunsang.tsering/Desktop/reddit-competitor-sentiment && echo \"Generating email for kunsang.tsering@hellofresh.com...\" && python3 -c \"\nimport subprocess\nfrom datetime import datetime, timedelta\nimport json\n\n# Generate fresh chart\nsubprocess.run(['python3', 'step1_chart.py'], capture_output=True)\n\n# Get weekly summary\nwith open('reports/working_reddit_data.json', 'r') as f:\n    data = json.load(f)\n\nposts = data.get('posts', [])\nseven_days_ago = datetime.now() - timedelta(days=7)\nseven_days_timestamp = seven_days_ago.timestamp()\n\nbrand_stats = {}\nfor post in posts:\n    created = post.get('created_utc', 0)\n    if created >= seven_days_timestamp:\n        brands = post.get('competitors_mentioned', [])\n        sentiment = post.get('sentiment', 'neutral')\n        \n        for brand in brands:\n            if brand not in brand_stats:\n                brand_stats[brand] = {'positive': 0, 'negative': 0, 'neutral': 0}\n            brand_stats[brand][sentiment] += 1\n\nsummary_lines = []\nsorted_brands = sorted(brand_stats.items(), key=lambda x: sum(x[1].values()), reverse=True)\n\nfor brand, stats in sorted_brands:\n    total = sum(stats.values())\n    pos_pct = int((stats['positive'] / total) * 100) if total > 0 else 0\n    \n    if brand in ['HelloFresh', 'Factor', 'EveryPlate', 'Green Chef']:\n        brand_name = f'{brand} (HF)'\n    else:\n        brand_name = brand\n    \n    summary_lines.append(f'â€¢ {brand_name} â€” {total} posts ({pos_pct}% positive)')\n\nend_date = datetime.now()\nstart_date = end_date - timedelta(days=7)\ndate_range = f'{start_date.strftime(\\\"%b %d\\\")}â€“{end_date.strftime(\\\"%d, %Y\\\")}'\n\nsubject = f'Weekly Reddit Competitor Sentiment Report â€” {date_range}'\n\nbody = f'''Hi Kunsang,\n\nHere's the weekly Reddit sentiment snapshot ({date_range}).\n\nEach count = unique Reddit post from the last 7 days (not comments or reposts)\n\n{chr(10).join(summary_lines)}\n\nWeekly data includes all HelloFresh family brands and key competitors.\n\nChart attached: step1_chart.png\n\nBest regards,\nReddit Sentiment Analysis System'''\n\n# Create email file for YOU to test\nemail_content = f'''To: kunsang.tsering@hellofresh.com\nSubject: {subject}\n\n{body}\n\nINSTRUCTIONS FOR TESTING:\n1. Copy the subject line above\n2. Copy the email body above  \n3. Open Gmail/Outlook and create new email\n4. Paste subject and body\n5. Attach the chart file: reports/step1_chart.png\n6. Send to yourself to test!\n\nOnce this works, change recipient to brian.leung@hellofresh.com'''\n\ntimestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\nemail_file = f'reports/email_test_{timestamp}.txt'\n\nwith open(email_file, 'w') as f:\n    write(email_content)\n\nprint(f'âœ… TEST EMAIL READY: {email_file}')\nprint(f'ðŸ“Š CHART READY: reports/step1_chart.png')\nprint(f'ðŸ“§ TEST RECIPIENT: kunsang.tsering@hellofresh.com')\n\""}},"jsonrpc":"2.0","id":14}
Subject: Weekly Reddit Competitor Sentiment Report â€” Oct 16â€“23, 2025

Hi Brian,

Here's the weekly Reddit sentiment snapshot (Oct 16â€“23, 2025).

Each count = unique Reddit post from the last 7 days (not comments or reposts)

â€¢ HelloFresh (HF) â€” 56 posts (25% positive)
â€¢ Blue Apron â€” 16 posts (18% positive)
â€¢ Home Chef â€” 8 posts (37% positive)
â€¢ Factor (HF) â€” 4 posts (100% positive)
â€¢ Marley Spoon â€” 3 posts (0% positive)
â€¢ HungryRoot â€” 1 posts (0% positive)

Weekly data includes all HelloFresh family brands and key competitors.

Chart attached: step1_chart.png

Best regards,
Reddit Sentiment Analysis System

---
Total posts analyzed: 88
Data source: Public Reddit posts from r/hellofresh, r/mealkits, r/mealprep, r/food, r/cooking
Next report: October 30, 2025

INSTRUCTIONS:
1. Copy the subject line above
2. Copy the email body above  
3. Open Gmail/Outlook and create new email
4. Paste subject and body
5. Attach the chart file: reports/step1_chart.png
6. Send!